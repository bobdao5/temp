var B={},E={},P={},T;function w(){if(T)return P;T=1,Object.defineProperty(P,"__esModule",{value:!0}),P.ERROR_PACKET=P.PACKET_TYPES_REVERSE=P.PACKET_TYPES=void 0;const e=Object.create(null);P.PACKET_TYPES=e,e.open="0",e.close="1",e.ping="2",e.pong="3",e.message="4",e.upgrade="5",e.noop="6";const d=Object.create(null);P.PACKET_TYPES_REVERSE=d,Object.keys(e).forEach(y=>{d[e[y]]=y});const s={type:"error",data:"parser error"};return P.ERROR_PACKET=s,P}var h;function v(){if(h)return E;h=1,Object.defineProperty(E,"__esModule",{value:!0}),E.encodePacket=E.encodePacketToBinary=void 0;const e=w(),d=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",s=typeof ArrayBuffer=="function",y=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,c=({type:t,data:o},i,a)=>d&&o instanceof Blob?i?a(o):u(o,a):s&&(o instanceof ArrayBuffer||y(o))?i?a(o):u(new Blob([o]),a):a(e.PACKET_TYPES[t]+(o||""));E.encodePacket=c;const u=(t,o)=>{const i=new FileReader;return i.onload=function(){const a=i.result.split(",")[1];o("b"+(a||""))},i.readAsDataURL(t)};function r(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let f;function n(t,o){if(d&&t.data instanceof Blob)return t.data.arrayBuffer().then(r).then(o);if(s&&(t.data instanceof ArrayBuffer||y(t.data)))return o(r(t.data));c(t,!1,i=>{f||(f=new TextEncoder),o(f.encode(i))})}return E.encodePacketToBinary=n,E}var b={},A={},R;function m(){if(R)return A;R=1,Object.defineProperty(A,"__esModule",{value:!0}),A.decode=A.encode=void 0;const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let c=0;c<e.length;c++)d[e.charCodeAt(c)]=c;const s=c=>{let u=new Uint8Array(c),r,f=u.length,n="";for(r=0;r<f;r+=3)n+=e[u[r]>>2],n+=e[(u[r]&3)<<4|u[r+1]>>4],n+=e[(u[r+1]&15)<<2|u[r+2]>>6],n+=e[u[r+2]&63];return f%3===2?n=n.substring(0,n.length-1)+"=":f%3===1&&(n=n.substring(0,n.length-2)+"=="),n};A.encode=s;const y=c=>{let u=c.length*.75,r=c.length,f,n=0,t,o,i,a;c[c.length-1]==="="&&(u--,c[c.length-2]==="="&&u--);const l=new ArrayBuffer(u),_=new Uint8Array(l);for(f=0;f<r;f+=4)t=d[c.charCodeAt(f)],o=d[c.charCodeAt(f+1)],i=d[c.charCodeAt(f+2)],a=d[c.charCodeAt(f+3)],_[n++]=t<<2|o>>4,_[n++]=(o&15)<<4|i>>2,_[n++]=(i&3)<<6|a&63;return l};return A.decode=y,A}var g;function p(){if(g)return b;g=1,Object.defineProperty(b,"__esModule",{value:!0}),b.decodePacket=void 0;const e=w(),d=m(),s=typeof ArrayBuffer=="function",y=(r,f)=>{if(typeof r!="string")return{type:"message",data:u(r,f)};const n=r.charAt(0);return n==="b"?{type:"message",data:c(r.substring(1),f)}:e.PACKET_TYPES_REVERSE[n]?r.length>1?{type:e.PACKET_TYPES_REVERSE[n],data:r.substring(1)}:{type:e.PACKET_TYPES_REVERSE[n]}:e.ERROR_PACKET};b.decodePacket=y;const c=(r,f)=>{if(s){const n=(0,d.decode)(r);return u(n,f)}else return{base64:!0,data:r}},u=(r,f)=>{switch(f){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}};return b}var C;function j(){return C||(C=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.decodePayload=e.decodePacket=e.encodePayload=e.encodePacketToBinary=e.encodePacket=e.protocol=e.decodePacketFromBinary=void 0;const d=v();Object.defineProperty(e,"encodePacket",{enumerable:!0,get:function(){return d.encodePacket}}),Object.defineProperty(e,"encodePacketToBinary",{enumerable:!0,get:function(){return d.encodePacketToBinary}});const s=p();Object.defineProperty(e,"decodePacket",{enumerable:!0,get:function(){return s.decodePacket}});const y=String.fromCharCode(30),c=(n,t)=>{const o=n.length,i=new Array(o);let a=0;n.forEach((l,_)=>{(0,d.encodePacket)(l,!1,k=>{i[_]=k,++a===o&&t(i.join(y))})})};e.encodePayload=c;const u=(n,t)=>{const o=n.split(y),i=[];for(let a=0;a<o.length;a++){const l=(0,s.decodePacket)(o[a],t);if(i.push(l),l.type==="error")break}return i};e.decodePayload=u;let r;function f(n,t,o){r||(r=new TextDecoder);const i=t||n[0]<48||n[0]>54;return(0,s.decodePacket)(i?n:r.decode(n),o)}e.decodePacketFromBinary=f,e.protocol=4}(B)),B}export{j as r};
